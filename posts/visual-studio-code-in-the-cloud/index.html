<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Arthur Turrell">
<meta name="dcterms.date" content="2022-09-28">

<title>Markov Wanderer - Visual Studio Code on the Cloud</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../logo.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Markov Wanderer - Visual Studio Code on the Cloud">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://github.com/aeturrell/coding-for-economists/blob/main/img/vscode_layout.png?raw=true">
<meta name="twitter:creator" content="@arthurturrell">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Markov Wanderer</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="http://aeturrell.github.io/home/" rel="" target=""><i class="bi bi-laptop" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/aeturrell" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arthurturrell" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Visual Studio Code on the Cloud</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">research</div>
                <div class="quarto-category">cloud</div>
                <div class="quarto-category">python</div>
                <div class="quarto-category">rstats</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Arthur Turrell </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 28, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#interactive-window-coding" id="toc-interactive-window-coding" class="nav-link active" data-scroll-target="#interactive-window-coding">Interactive Window Coding</a></li>
  <li><a href="#setting-up" id="toc-setting-up" class="nav-link" data-scroll-target="#setting-up">Setting Up</a></li>
  <li><a href="#creating-a-cloud-vm-instance" id="toc-creating-a-cloud-vm-instance" class="nav-link" data-scroll-target="#creating-a-cloud-vm-instance">Creating a Cloud VM Instance</a></li>
  <li><a href="#connecting-to-a-running-gcp-virtual-machine-instance-from-visual-studio-code" id="toc-connecting-to-a-running-gcp-virtual-machine-instance-from-visual-studio-code" class="nav-link" data-scroll-target="#connecting-to-a-running-gcp-virtual-machine-instance-from-visual-studio-code">Connecting to a running GCP Virtual Machine Instance from Visual Studio Code</a></li>
  <li><a href="#using-python-on-your-cloud-vm-instance" id="toc-using-python-on-your-cloud-vm-instance" class="nav-link" data-scroll-target="#using-python-on-your-cloud-vm-instance">Using Python on your Cloud VM Instance</a>
  <ul class="collapse">
  <li><a href="#setting-up-conda" id="toc-setting-up-conda" class="nav-link" data-scroll-target="#setting-up-conda">Setting up conda</a></li>
  </ul></li>
  <li><a href="#moving-data-in-and-out-of-your-vm" id="toc-moving-data-in-and-out-of-your-vm" class="nav-link" data-scroll-target="#moving-data-in-and-out-of-your-vm">Moving Data In and Out of Your VM</a>
  <ul class="collapse">
  <li><a href="#putting-data-on-the-cloud" id="toc-putting-data-on-the-cloud" class="nav-link" data-scroll-target="#putting-data-on-the-cloud">Putting Data on the Cloud</a></li>
  <li><a href="#moving-data-from-a-bucket-to-your-vm-and-back" id="toc-moving-data-from-a-bucket-to-your-vm-and-back" class="nav-link" data-scroll-target="#moving-data-from-a-bucket-to-your-vm-and-back">Moving Data from a Bucket to Your VM (and back)</a></li>
  </ul></li>
  <li><a href="#finishing" id="toc-finishing" class="nav-link" data-scroll-target="#finishing">Finishing</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Visual Studio Code is incredibly powerful, whether it’s for writing <a href="https://aeturrell.github.io/coding-for-economists/wrkflow-markdown.html">markdown</a>, writing <a href="https://aeturrell.github.io/coding-for-economists/wrkflow-quarto.html">quarto</a> (.qmd) files, getting syntax highlighting and peerless language support (eg auto-completion), getting peerless git support, working with a <a href="https://github.com/features/copilot">co-pilot</a>, <a href="https://visualstudio.microsoft.com/services/live-share/">working with collaborators in real-time</a>, or even running <a href="../../posts/setting-up-r-in-vscode/index.html">R code in a modern REPL</a>. For me, it’s the best IDE by some way. One of its strongest features for data science is its ability to do interactive window coding with scripts <em>and</em> notebooks. Yet most online or cloud-based data science services focus only on notebooks. Wouldn’t it be great if there was a reliable way to use all of Visual Studio Code’s features in the cloud?<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>In this blog post, I’ll show you how to set up Visual Studio Code on your desktop so that it connects remotely to a cloud virtual machine. This will allow you to code on the cloud as if you were developing locally.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>Why should you care? Because having a reproducible environment on the cloud that you can use with your cutting-edge tools is pretty nifty!</p>
<p>There are pre-made resources out there that do this already such as <a href="https://github.com/features/codespaces">Github Codespaces</a> and <a href="https://www.gitpod.io/">Gitpod</a>, which even has a free tier. They are incredible and well worth checking out for, more or less, a one click solution for fully-featued Visual Studio Code in the cloud. But they’re probably a bit more pricey than a roll your own version, clearly have less flexibility in terms of virtual machines, and don’t come with the nice data backends that are provided by a huge cloud provider (yet).</p>
<section id="interactive-window-coding" class="level2">
<h2 class="anchored" data-anchor-id="interactive-window-coding">Interactive Window Coding</h2>
<p>If you’re not familiar with it, the <em>interactive window</em><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> is a convenient and flexible way to run code that you have open in a script or that you type directly into the interactive window code box. It allows you to remix, explore, and try out code one line at a time or in chunks or as a whole script–which makes it perfect for analysis and data science on those occassions when you don’t need text alongside code. You can find out more about <a href="https://aeturrell.github.io/python4DS/introduction.html#installing-visual-studio-code-to-run-python">how to set up interactive window coding in Python with Visual Studio Code here</a> (and R <a href="http://aeturrell.com//2021/11/04/setting-up-r-in-vscode/">here</a>). More generally, Visual Studio Code is a fantastic environment for doing data science in and many of its features eventually got adopted by other tools.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://github.com/aeturrell/coding-for-economists/blob/main/img/vscode_layout.png?raw=true" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Typical layout of Visual Studio Code</figcaption>
</figure>
</div>
<p>The figure above shows the typical layout of Visual Studio Code. Number 5 is the interactive Python window, which is where code and code outputs appear after you select and execute them from a script (number 3) or just by writing in the box ‘Type code here’ box.</p>
</section>
<section id="setting-up" class="level2">
<h2 class="anchored" data-anchor-id="setting-up">Setting Up</h2>
<p>There are two pieces to this puzzle: Visual Studio Code and Google Cloud.</p>
<p>First, grab Visual Studio Code for your local computer (ie your non-cloud computer) and whatever extensions you fancy, but you’ll need <a href="https://code.visualstudio.com/docs/remote/ssh">the remote explorer (SSH)</a> at a minimum.</p>
<p>You’ll also need to install the <a href="https://cloud.google.com/sdk">Google Cloud SDK</a> (a command line tool for interacting with GCP; SDK stands for ‘software development kit’) on your computer. Once you have downloaded and installed it, run <code>gcloud init</code> to set it up. This is the point at which your computer becomes trusted to do things to your GCP account.</p>
<p>Anything the Google Cloud SDK can do, Python (and C, C++, C#, Go, Java, Node.js, PHP, and Ruby) can do too, if you’d rather work with them. (R isn’t supported by the SDK yet.) However, here we’ll follow the instructions for doing this all in the command line.</p>
</section>
<section id="creating-a-cloud-vm-instance" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-cloud-vm-instance">Creating a Cloud VM Instance</h2>
<p>You’ll need a Google Cloud Platform (GCP) account. New accounts get some free credit but you’ll typically need to add some billing information. Set up a new project on the Google Cloud Console, and enable the ‘Google Cloud Compute API’ (found under VM Instances).</p>
<p>Now you will set up a virtual machine. You can do this either through the set of menus or via the command line. For the menu options, go to the VM instances page and click ‘Create Instance’, then fill in the form with info on the computer you want.</p>
<p>If you’re going for the command line approach, you can do this all in one fell swoop by running</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gcloud</span> compute instances create instance-name <span class="at">--project</span><span class="op">=</span>PROJECT-NAME <span class="at">--zone</span><span class="op">=</span>europe-west2-c <span class="at">--machine-type</span><span class="op">=</span>e2-standard-2 <span class="at">--network-interface</span><span class="op">=</span>network-tier=PREMIUM,subnet=default <span class="at">--maintenance-policy</span><span class="op">=</span>MIGRATE <span class="at">--provisioning-model</span><span class="op">=</span>STANDARD <span class="at">--service-account</span><span class="op">=</span>PROJECT-NUMBER-compute@developer.gserviceaccount.com <span class="at">--scopes</span><span class="op">=</span>https://www.googleapis.com/auth/devstorage.read_only,https://www.googleapis.com/auth/logging.write,https://www.googleapis.com/auth/monitoring.write,https://www.googleapis.com/auth/servicecontrol,https://www.googleapis.com/auth/service.management.readonly,https://www.googleapis.com/auth/trace.append <span class="at">--create-disk</span><span class="op">=</span>auto-delete=yes,boot=yes,device-name=instance-1,image=projects/debian-cloud/global/images/debian-11-bullseye-v20220920,mode=rw,size=10,type=projects/chipshop/zones/us-central1-a/diskTypes/pd-balanced <span class="at">--no-shielded-secure-boot</span> <span class="at">--shielded-vtpm</span> <span class="at">--shielded-integrity-monitoring</span> <span class="at">--reservation-affinity</span><span class="op">=</span>any</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where <code>instance-name</code> is the name you give the instance (you need to choose this now), <code>PROJECT-NAME</code> is the name of the project you’ve created, and <code>PROJECT-NUMBER</code> is the project number of that project. Note that these are fairly default settings with a London-based e2 machine running Bullseye Debian (a type of Linux).</p>
<p>If you did the above and all has worked you should now be able to see a new line in the VM instances page on the GCP pages that has a ‘running’ symbol under ‘Status’; yes, your VM is already running! (And racking up costs but this is a small machine so not much cost per hour–but you may wish to turn on billing alerts at this point!)</p>
<p>You can jump straight to your new VM’s command line using Google’s simple approach by clicking on their ‘SSH’ button on the line where your running VM instance appears on the VM instances page. But this only gets a command line, not Visual Studio Code…</p>
</section>
<section id="connecting-to-a-running-gcp-virtual-machine-instance-from-visual-studio-code" class="level2">
<h2 class="anchored" data-anchor-id="connecting-to-a-running-gcp-virtual-machine-instance-from-visual-studio-code">Connecting to a running GCP Virtual Machine Instance from Visual Studio Code</h2>
<p>Okay, so your GCP VM instance is running and now you’re going to connect to it with Visual Studio Code.</p>
<p>First, we need to set up the SSH connection between your computer and your running cloud VM; essentially a way for them to talk to each other. You can find out more about SSH authentication <a href="https://www.ssh.com/academy/ssh/protocol">here</a>. Open up VS Code and its integrated terminal (<kbd>ctrl</kbd>+<kbd>`</kbd> shortcut on a Mac). Make sure you are in the correct GCP project by running</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gcloud</span> config set project PROJECT-NAME</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>on the command line. If you already tried this process and aborted it, you may need to remove your existing Google keys; they’re stored in the directory <code>~/.ssh/</code>. Now create the SSH settings for your new instance using</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gcloud</span> compute config-ssh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You’ll get a message like</p>
<pre class="text"><code>WARNING: The private SSH key file for gcloud does not exist.
WARNING: The public SSH key file for gcloud does not exist.
WARNING: You do not have an SSH key for gcloud.
WARNING: SSH keygen will be executed to generate a key.
Generating public/private rsa key pair.
Enter passphrase (empty for no passphrase): [can enter one here]
Enter same passphrase again: [can enter one here]
Your identification has been saved in /Users/USERNAME/.ssh/google_compute_engine
Your public key has been saved in /Users/USERNAME/.ssh/google_compute_engine.pub
The key fingerprint is:
SHA256:YOUR-FINGERPRINT USERNAME@LOCAL-COMPUTER-NAME
The key's randomart image is:
+---[RSA 3072]----+
|                 |
| TEXT-ART-IMAGE  |
|                 |
+----[SHA256]-----+
Updating project ssh metadata...⠼Updated [https://www.googleapis.com/compute/v1/projects/PROJECT-NAME].  
Updating project ssh metadata...done.
You should now be able to use ssh/scp with your instances.
For example, try running:

  $ ssh INSTANCE-NAME.europe-west2-c.PROJECT-NAME</code></pre>
<p>Okay, this means your connection configurations have been set up successfuly. (Note: don’t run <code>ssh INSTANCE-NAME.europe-west2-c.PROJECT-NAME</code> directly on your command line, as you will just ssh into the cloud instance’s command line rather than open Visual Studio Code in the VM.)</p>
<p>Within Visual Studio Code on your local computer, go to the remote explorer tab, which you can find on the left hand side (you’ll need to have installed the remote explorer package for SSH). Choose ‘SSH Targets’ from the drop-down menu at the top. Then you should see an entry listed for INSTANCE-NAME.europe-west2-c.PROJECT-NAME. Right-click on it and choose ‘connect to host in new window’.</p>
<p>A new Visual Studio Code window will open and you will be asked whether you recognise the VM. Then you will be asked for a passphrase, if you chose to create one earlier.</p>
<p>Congratulations, you should now be on your VM instance using Code! You can check because the green text in the bottom left-hand corner of Visual Studio Code should read</p>
<blockquote class="blockquote">
<p>SSH: INSTANCE-NAME.europe-west2-c.PROJECT-NAME</p>
</blockquote>
<p>First, you’ll want to open up a folder to work in. Perhaps you want to git clone a repository and then open that? Git doesn’t come pre-installed so you’ll need to run <code>sudo apt-get install git</code> first. You can just open the home directory too. Either way, open up a folder.</p>
</section>
<section id="using-python-on-your-cloud-vm-instance" class="level2">
<h2 class="anchored" data-anchor-id="using-python-on-your-cloud-vm-instance">Using Python on your Cloud VM Instance</h2>
<p>If you used Google’s image “debian-11-bullseye-v20220920” then it will come with a version of Python already installed (Python 3.9.12) and you can check the version with <code>python -V</code> on the command line. Note that <strong>pip</strong> (used for installing Python packages) may not itself be installed–you can install it on Debian linux by running <code>sudo apt-get install pip</code> on the command line.</p>
<p>Next, you will need to install the Visual Studio Code <a href="https://marketplace.visualstudio.com/items?itemName=ms-python.python">Python extension</a> (65 million installs and counting) on <em>the cloud instance</em>. Do that, then open up a Python script (you can run <code>echo "print('hello world')" &gt; hello.py</code> if you need inspiration for a simple script).</p>
<p>The interactive window depends on one package, <code>ipykernel</code>, that you probably don’t have already. Once you’ve installed <strong>pip</strong>, you’ll need to run <code>pip install ipykernel</code> on the command line.</p>
<p>Now, select the code you’d like to run in your Python script, right-click, and select ‘Run Selection/Line in Interactive Window’. You can also hit <kbd>shift</kbd> + <kbd>enter</kbd> with the code selected.</p>
<p>You should find that a Visual Studio Code interactive window launches and runs your code on the cloud!</p>
<p>And notebooks work too–try <code>touch notebook.ipynb</code> on the command line, opening the file in Visual Studio Code, and then add <code>print("hello world")</code> to the first cell and run it.</p>
<section id="setting-up-conda" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-conda">Setting up conda</h3>
<p>Lots of data scientists use the Anaconda distribution of Python. It’s not on the base image we’re using, “debian-11-bullseye-v20220920”, by default, though of course you could choose an image that does have it if you want, or roll your own, when you create your VM instance. If you’re using this Debian option though, and you want to install Anaconda after the fact, the instructions are below. (We’ll work with the light-weight Anaconda version called ‘miniconda’.)</p>
<p>First you’ll need the <code>wget</code> Linux programme. Run</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get install wget</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to grab that. Next, let’s get the install script for Miniconda and run it:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> Miniconda3-latest-Linux-x86_64.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will install Miniconda. Relaunch the terminal and you should see the familiar <code>(base)</code> prompt appearing so that your VM command line prompt now looks like</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">base</span><span class="kw">)</span> <span class="ex">USERNAME@INSTANCE-NAME:~$</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Another way to check is to run <code>conda info</code>, which will tell you all about your conda installation.</p>
<p>Now, due to the license on Anaconda, you may wish to set <code>conda install</code> to only grab packages from the <code>conda-forge</code> channel. You can do that with a couple of commands:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> config <span class="at">--add</span> channels conda-forge</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to add conda forge as a channel for package downloads and put it first, and</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> config <span class="at">--set</span> channel_priority strict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to get strict channel priority of conda forge, ie to always prefer that channel no matter what package is being installed. (It’s a bad idea to mix the conda forge and default channels.)</p>
</section>
</section>
<section id="moving-data-in-and-out-of-your-vm" class="level2">
<h2 class="anchored" data-anchor-id="moving-data-in-and-out-of-your-vm">Moving Data In and Out of Your VM</h2>
<p>Data scientists can’t data science without data.</p>
<section id="putting-data-on-the-cloud" class="level3">
<h3 class="anchored" data-anchor-id="putting-data-on-the-cloud">Putting Data on the Cloud</h3>
<p>There are many types of cloud data storage; here, we’ll just use the most popular (but perhaps not the best for your particular use case so worth reading up on what would best serve your requirements).</p>
<p>To create a new cloud data bucket, which persists separately to any VM instances, the command is</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gcloud</span> storage buckets create gs://BUCKET_NAME <span class="at">--project</span><span class="op">=</span>PROJECT_ID <span class="at">--location</span><span class="op">=</span>BUCKET_LOCATION</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For this project, we’ll accept the defaults except for setting the location to “europe-west2”. To upload data, it’s</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gcloud</span> storage cp OBJECT_LOCATION gs://DESTINATION_BUCKET_NAME/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example, to move a csv file called “glue.csv” that is in the working directory of the terminal,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">glcoud</span> storage cp glue.csv gs://DESTINATION_BUCKET_NAME/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After running this, you should be able to see the data appear in your bucket. The link to view it in the Google Cloud Console will be</p>
<pre class="text"><code>https://console.cloud.google.com/storage/browser?project=PROJECT-NAME&amp;prefix=</code></pre>
<p>and then click on the name you gave your bucket.</p>
</section>
<section id="moving-data-from-a-bucket-to-your-vm-and-back" class="level3">
<h3 class="anchored" data-anchor-id="moving-data-from-a-bucket-to-your-vm-and-back">Moving Data from a Bucket to Your VM (and back)</h3>
<p>Okay, so now your data is on the cloud–but it’s not on your VM! We’re back in Visual Studio Code on the VM, and using the integrated terminal. To copy data from the bucket to the VM, the command to use <em>on the terminal in the VM</em> is</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gcloud</span> storage cp <span class="at">-r</span> gs://BUCKET-NAME/ DESTINATION-FOLDER/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>-r</code> flag makes this recursive, while <code>cp</code> means copy. So, following our example you could make a directory data <code>mkdir data</code> and then run</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gcloud</span> storage cp <span class="at">-r</span> gs://BUCKET-NAME/ data/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To move any data back to the bucket when you are done is the same command you used for moving data onto the bucket in the first place, ie</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">glcoud</span> storage cp FILE-NAME gs://DESTINATION_BUCKET_NAME/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="finishing" class="level2">
<h2 class="anchored" data-anchor-id="finishing">Finishing</h2>
<p>Remember: best practice is to treat a cloud instance as temporary. Shunt data you want to save in and out when you use it, and use version control for code. And most of all, <strong>don’t forget to turn your VM instance off when you’ve finished using it!</strong></p>
<p>Hopefully this has been a useful summary of how to use Visual Studio Code in the cloud, especially using the interactive window for Python coding. Happy coding!</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>If you have a GitHub account you can just press ‘.’ on a repo and it will load up something that looks a lot like Visual Studio Code but this can’t run code, it’s only a text editor.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We’ll be using Google Cloud Compute but the concepts will be similar for other cloud services. You should also note that using cloud services is usually charged though free credits are often available for new accounts. Also, this has only been tested on MacOS.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>This is actually a special kind of ipython console.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>